<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.68">
<title data-react-helmet="true">Compute Distances | Smart Data Lake Builder</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Compute Distances | Smart Data Lake Builder"><meta data-react-helmet="true" name="description" content="Goal"><meta data-react-helmet="true" property="og:description" content="Goal"><meta data-react-helmet="true" property="og:url" content="https://pgruetter.github.io/sdl-docs/docs/getting-started/compute-distances"><link data-react-helmet="true" rel="shortcut icon" href="/sdl-docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pgruetter.github.io/sdl-docs/docs/getting-started/compute-distances"><link rel="stylesheet" href="/sdl-docs/styles.1bc85f62.css">
<link rel="preload" href="/sdl-docs/styles.0d373285.js" as="script">
<link rel="preload" href="/sdl-docs/runtime~main.62826e6e.js" as="script">
<link rel="preload" href="/sdl-docs/main.2f23556c.js" as="script">
<link rel="preload" href="/sdl-docs/1.f3842da1.js" as="script">
<link rel="preload" href="/sdl-docs/29.75129747.js" as="script">
<link rel="preload" href="/sdl-docs/30.34993a47.js" as="script">
<link rel="preload" href="/sdl-docs/935f2afb.b9ea6650.js" as="script">
<link rel="preload" href="/sdl-docs/28.5de40dea.js" as="script">
<link rel="preload" href="/sdl-docs/c1b8e3de.fb8de136.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/sdl-docs/"><img src="/sdl-docs/img/sdl_logo.png" alt="Smart Data Lake Logo" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img alt="Smart Data Lake Logo" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">Smart Data Lake</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/sdl-docs/docs/">Docs</a><a class="navbar__item navbar__link" href="/sdl-docs/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/smart-data-lake/smart-data-lake" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/sdl-docs/"><img src="/sdl-docs/img/sdl_logo.png" alt="Smart Data Lake Logo" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img alt="Smart Data Lake Logo" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">Smart Data Lake</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/sdl-docs/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/sdl-docs/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/smart-data-lake/smart-data-lake" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive thin-scrollbar menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Smart Data Lake</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sdl-docs/docs/">Introduction</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/sdl-docs/docs/getting-started/setup">Technical Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/sdl-docs/docs/getting-started/get-input-data">Inputs</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Part 1</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/sdl-docs/docs/getting-started/get-departures">Get Departures</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/sdl-docs/docs/getting-started/get-airports">Get Airports</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/sdl-docs/docs/getting-started/select-columns">Select Columns</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/sdl-docs/docs/getting-started/joining-it-together">Joining It Together</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/sdl-docs/docs/getting-started/joining-departures-and-arrivals">Get Departure Coordinates</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/sdl-docs/docs/getting-started/compute-distances">Compute Distances</a></li></ul></li></ul></li></ul></div><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_2Tub"></button></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_39qw"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Compute Distances</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="goal"></a>Goal<a aria-hidden="true" class="hash-link" href="#goal" title="Direct link to heading">#</a></h2><p>In this part, we will compute the distances between departure and arrival airports
so that our railway enthusiast Tom can see which planes could be replaced by rail traffic.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="define-output-object"></a>Define output object<a aria-hidden="true" class="hash-link" href="#define-output-object" title="Direct link to heading">#</a></h2><p>Let&#x27;s define our final output object for this part:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  btl-distances {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type = CsvFileDataObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    path = &quot;~{id}&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="define-compute_distances-action"></a>Define compute_distances action<a aria-hidden="true" class="hash-link" href="#define-compute_distances-action" title="Direct link to heading">#</a></h2><p>How do we compute the distances ?
The answer is in the file <em>src/main/scala/com/sample/ComputeDistanceTransformer.scala</em>.</p><p>So far, we only used SQL transformers.
But more complex transformations can be written in custom code and referenced in the config.
This gives you great flexibility for cases with specific business logic, such as this one.</p><p>We have one input and one output: therefore our custom class is a <em>CustomDfTransformer</em> (instead of CustomDf<strong>s</strong>Transformer).
It takes the input dataframe <em>df</em> and calls a User Defined Function called <em>calculateDistanceInKilometerUdf</em>
to do the computation.
It expects the column names dep_latitude_deg, dep_longitude_deg, arr_latitude_deg and arr_longitude_deg in the input.
This matches the column names we used in the SQL-Code in the last-step.</p><p>We won&#x27;t go into the details of the Udf.
You can follow this <a href="https://stackoverflow.com/questions/27928/calculate-distance-between-two-latitude-longitude-points-haversine-formula" target="_blank" rel="noopener noreferrer">stackoverflow link</a>
if you want to learn more.</p><p>Finally, the transformation writes the result into a column called distance.
It also adds a column <em>could_be_done_by_rail</em> to the output that simply checks if the distance is smaller than 500 km.</p><p>In order to wire this CustomTransformation into our config, we add the following action:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  compute-distances {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type = CopyAction</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    inputId = btl-departures-arrivals-airports</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    outputId = btl-distances</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    transformers = [{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      type = ScalaClassDfTransformer</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      className = com.sample.ComputeDistanceTransformer</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    metadata {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      feed = compute</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>We used a CopyAction and told it to execute the code in the class <em>com.sample.ComputeDistanceTransformer</em> to transform the data.
We could also have used a CustomSparkAction like in the previous step,
but this would have resulted in more complex code working with lists of inputs, outputs and transformers.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="try-it-out"></a>Try it out<a aria-hidden="true" class="hash-link" href="#try-it-out" title="Direct link to heading">#</a></h2><p><a target="_blank" href="/sdl-docs/assets/files/application-compute-part1-final-cff8f745969f561043ab208ed5fe0959.conf">This</a> is how the final config-file looks like.</p><p>You can execute the usual <em>docker run</em> command :</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --rm -v ${PWD}/data:/mnt/data -v ${PWD}/config:/mnt/config demo:latest -c /mnt/config --feed-sel compute</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Under <em>data/btl-distances</em> you can now see the final result. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="the-execution-dag-of-the-compute-feed"></a>The Execution DAG of the compute feed<a aria-hidden="true" class="hash-link" href="#the-execution-dag-of-the-compute-feed" title="Direct link to heading">#</a></h3><p>In the console, you probably started noticing some pretty ASCII Art that looks like this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     â”Œâ”€â”€â”€â”€â”€â”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     â”‚startâ”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     â””â”¬â”€â”€â”¬â”€â”˜</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                      â”‚  â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                      v                      â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> â”‚select-airport-cols SUCCEEDED PT4.421793Sâ”‚ â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 â”‚                           â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 v                           v</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> â”‚join_departures_airports SUCCEEDED PT2.938995Sâ”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        v</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â”‚compute_distances SUCCEEDED PT1.160045Sâ”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>This is the Execution <em>DAG</em> of our data pipeline.
SDL internally builds a Directed Acyclic Graph (DAG) to analyze all dependencies between your actions.
Because it&#x27;s acyclic, it cannot have loops, so it&#x27;s impossible to define an action that depends on an output of subsequent actions.
SDL uses this DAG to optimize execution of your pipeline as it knows in which order the pipeline needs to execute.</p><p>What you see in the logs, is a representation of what the SDL has determined as dependencies.
If you don&#x27;t get the results you expect, it&#x27;s good to check if the DAG looks correct.
At the end you will also see the graph again with status indicators (SUCCEEDED, CANCELLED, ...) and the duration it took to execute the action.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Hold on</h5></div><div class="admonition-content"><p>It&#x27;s worth pausing at this point to appreciate this fact:<br>
You didn&#x27;t have to explicitly tell SDL how to execute your actions.
You also didn&#x27;t have to define the dependencies between your actions.
Just from the definitions of DataObjects and Actions alone, SDL builds a DAG and knows what needs to be executed and how.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="the-execution-dag-of-the--feed"></a>The Execution DAG of the .* feed<a aria-hidden="true" class="hash-link" href="#the-execution-dag-of-the--feed" title="Direct link to heading">#</a></h3><p>You can also execute the entire data pipeline by selecting all feeds:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --rm -v ${PWD}/data:/mnt/data -v ${PWD}/config:/mnt/config smart-data-lake/gs1:latest --config /mnt/config --feed-sel .*</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>The successful execution DAG looks like this</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                        â”Œâ”€â”€â”€â”€â”€â”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                        â”‚startâ”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                        â””â”€â”¬â”€â”¬â”€â”˜</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                          â”‚ â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                          v                       â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">               â”‚download-airports SUCCEEDED PT8.662886Sâ”‚          â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">               â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                      â”‚                                           â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                      v                                           v</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> â”‚select-airport-cols SUCCEEDED PT4.629163Sâ”‚ â”‚download-departures SUCCEEDED PT0.564972Sâ”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                    v               v</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    â”‚join_departures_airports SUCCEEDED PT4.453514Sâ”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                           â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                           v</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                       â”‚compute_distances SUCCEEDED PT1.404391Sâ”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>SDL was able to determine that download-airports and download-departures can be executed in parallel,
independently from each other. It&#x27;s only at join-departures-airports and beyond that both Data Sources are needed.</p><p>SDL has command-line option called --parallelism which allows you to set the degree of parallelism used when executing the DAG run.
Per default, it&#x27;s set to 1.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="the-execution-dag-of-the-failed--feed"></a>The Execution DAG of the failed .* feed<a aria-hidden="true" class="hash-link" href="#the-execution-dag-of-the-failed--feed" title="Direct link to heading">#</a></h3><p>If you set the option <em>readTimeoutMs=0</em> in the DataObject <em>ext-departures</em>  it&#x27;s possible that the <em>download-departures</em> action fails.
That&#x27;s because SDL abandons the download because the REST-Service is too slow to respond.
If that happens, the DAG will look like this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">21/09/14 09:05:36 ERROR ActionDAGRun: Exec: TaskFailedException: Task download-departures failed. Root cause is &#x27;WebserviceException: connect timed out&#x27;: WebserviceException: connect timed out</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">21/09/14 09:05:36 INFO ActionDAGRun$: Exec FAILED for .* runId=1 attemptId=1:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                       â”Œâ”€â”€â”€â”€â”€â”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                       â”‚startâ”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                       â””â”€â”¬â”€â”¬â”€â”˜</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                         â”‚ â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                         â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                         v                       â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              â”‚download-airports SUCCEEDED PT6.638844Sâ”‚          â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                      â”‚                                          â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                      v                                          v</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> â”‚select-airport-cols SUCCEEDED PT3.064118Sâ”‚ â”‚download-departures FAILED PT1.084153Sâ”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                    â”‚           â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                    v           v</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        â”‚join-departures-airports CANCELLEDâ”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                          â”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                          v</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            â”‚compute-distances CANCELLEDâ”‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>As you can see, in this example, the action <em>download-departures</em> failed because of a timeout.
Because SDL determined that both downloads are independent, it was able to complete <em>select-airport-cols</em> succesfully.</p><p>As explained in <a href="/sdl-docs/docs/getting-started/select-columns#more-on-feeds">a previous step of the guide</a>,
if your download fails you will have to re-execute the download feed before being able to execute
.* again.</p><p><strong>Congratulations!</strong><br>
You successfully recreated the configuration file that is contained in the Docker Image you ran in the first step.
If you look at <a href="/sdl-docs/docs/getting-started/setup">the docker command on the first step</a>, you will notice that there was no path specified for the configuration file.
By default, SDL looks for the config under <em>src/main/resources</em>, which is also part of the Docker Image that you created.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="coming-next-in-part-2"></a>Coming Next in Part 2<a aria-hidden="true" class="hash-link" href="#coming-next-in-part-2" title="Direct link to heading">#</a></h2><p>Deduplication, Historization...</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/sdl-docs/docs/getting-started/joining-departures-and-arrivals"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Get Departure Coordinates</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#goal" class="table-of-contents__link">Goal</a></li><li><a href="#define-output-object" class="table-of-contents__link">Define output object</a></li><li><a href="#define-compute_distances-action" class="table-of-contents__link">Define compute_distances action</a></li><li><a href="#try-it-out" class="table-of-contents__link">Try it out</a><ul><li><a href="#the-execution-dag-of-the-compute-feed" class="table-of-contents__link">The Execution DAG of the compute feed</a></li><li><a href="#the-execution-dag-of-the--feed" class="table-of-contents__link">The Execution DAG of the .* feed</a></li><li><a href="#the-execution-dag-of-the-failed--feed" class="table-of-contents__link">The Execution DAG of the failed .* feed</a></li></ul></li><li><a href="#coming-next-in-part-2" class="table-of-contents__link">Coming Next in Part 2</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/sdl-docs/docs/">Getting started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/smart-data-lake/smart-data-lake" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://github.com/smart-data-lake/smart-data-lake/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Issues</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/sdl-docs/blog">Blog</a></li><li class="footer__item"><a href="https://www.elca.ch" target="_blank" rel="noopener noreferrer" class="footer__link-item">ELCA</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2021 Smart Data Lake, Built with Docusaurus.</div></div></div></footer></div>
<script src="/sdl-docs/styles.0d373285.js"></script>
<script src="/sdl-docs/runtime~main.62826e6e.js"></script>
<script src="/sdl-docs/main.2f23556c.js"></script>
<script src="/sdl-docs/1.f3842da1.js"></script>
<script src="/sdl-docs/29.75129747.js"></script>
<script src="/sdl-docs/30.34993a47.js"></script>
<script src="/sdl-docs/935f2afb.b9ea6650.js"></script>
<script src="/sdl-docs/28.5de40dea.js"></script>
<script src="/sdl-docs/c1b8e3de.fb8de136.js"></script>
</body>
</html>